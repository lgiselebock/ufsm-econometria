---
title: "Análises Econométricas"
subtitle: "Regressões Lineares"
author: "Luísa Gisele Böck"
date: "Junho de 2023"
encoding: "UTF-8"
output:
  xaringan::moon_reader:
    seal: false
    # lib_dir: libs
    # chakra: libs/remark-latest.min.js
    css: ["xaringan-themer.css", "custom.css", "footer-header.css"]
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(
  fig.width=9, fig.height=3.5, fig.retina=3,
  out.width = "100%",
  cache = FALSE,
  echo = TRUE,
  message = FALSE, 
  warning = FALSE,
  hiline = TRUE,
  erros = FALSE
)

library(tidyverse)
options(scipen = 99999)
```

```{r xaringan-themer, include=FALSE, warning=FALSE}
xaringanthemer::style_duo_accent(
  primary_color = "#005c8b",
  secondary_color = "#0073ae",
  inverse_header_color = "#FFFFFF"
)
```

```{r xaringanExtra, echo=FALSE}
#devtools::install_github("gadenbuie/xaringanExtra")
# xaringanExtra::use_xaringan_extra(c("tile_view", "animate_css", "tachyons"))

xaringanExtra::use_clipboard()

xaringanExtra::use_fit_screen()

xaringanExtra::use_extra_styles(
  hover_code_line = TRUE,         #<<
  mute_unhighlighted_code = TRUE  #<<
)

xaringanExtra::use_panelset()
```

```{r xaringanExtra-share-again, echo=FALSE}
xaringanExtra::use_share_again()
```

<!-- inicio font awesome -->
<script src="https://kit.fontawesome.com/1f72d6921a.js" crossorigin="anonymous"></script>
<!-- final font awesome -->

<!-- inicio github buttons  -->
<script async defer src="https://buttons.github.io/buttons.js"></script>
<!-- final github buttons  -->


.pull-left[
<br>
<br>
<br>
<br>
<br>
## Análises Econométricas

### Regressões Lineares

**[Luísa Gisele Böck](https://luisa.rbind.io/)**&nbsp;&nbsp;    <a href='mailto:luisa.bock@acad.ufsm.br'><i class="far fa-envelope"></i></a>    <a href='https://twitter.com/lgiselebock'><i class="fab fa-twitter"></i>   <a href='https://github.com/lgiselebock'><i class="fab fa-github"></i></a>

__.can-edit[Junho de 2023]__

]

.pull-right[
<br>
<br>
<br>
<br>
<br>
```{r echo=FALSE, out.width="700px"}
knitr::include_graphics("img/slides/46-intro-allison-horst-regressao-05.png")
```

.center[Ilustração por [Allison Horst](https://twitter.com/allison_horst/)]
]

---

class: inverse center middle

# Regressão Linear

.center[(Acompanhe no arquivo `05-regressao.R`)]

---

class: inverse center middle

# Dados Educacionais

<!-- .center[(Acompanhe no arquivo `04-visualizacao.R`)] -->

---

### Importando as bases

.tiny[
```{r}
library(tidyverse) # pacote necessário

ideb_fund <- read_csv("dados/educacionais/ideb_fundamental.csv", 
  col_types = cols(
    id_municipio = col_character(), ano = col_integer())
)
ideb_medio <- read_csv("dados/educacionais/ideb_medio.csv", 
  col_types = cols(
    id_municipio = col_character(), ano = col_integer())
)
indic_fund <- 
  read_csv("dados/educacionais/indicadores_fundamental.csv",
  col_types = cols(
    id_municipio = col_character(), ano = col_integer())
)
indic_medio <- read_csv("dados/educacionais/indicadores_medio.csv",
  col_types = cols(
    id_municipio = col_character(), ano = col_integer())
)
pib_pop <- read_csv("dados/educacionais/pib_pc.csv",
  col_types = cols(
    id_municipio = col_character(), ano = col_integer())
)
```
]

---

<div class="panelset">
<div class="panel">
<div class="panel-name">Ideb</div>

.tiny[
```{r}
head(ideb_fund, n = 5)

head(ideb_medio, n = 5)
```
]

</div>
<div class="panel">
<div class="panel-name">Dicionário</div>

**BASES IDEB_FUND E IDEB_MEDIO**

- **Fund:** Ensino Fundamental

- **Medio:** Ensino Médio

1. `id_municipio`: código do IBGE de identificação do município

2. `tx_aprov`: taxa de aprovação média do município 

3. `ideb`: índice de desenvolvimento da educação básica

  - é calculado a partir dos dados de aprovação escolar (obtidos pelo Censo Escolar) e das médias de desempenho no Sistema de Avaliação da Educação Básica (Saeb)

</div>
<div class="panel">
<div class="panel-name">Indicadores</div>

.tiny[
```{r}
head(indic_fund, n = 5)

head(indic_medio, n = 5)
```
]

</div>
<div class="panel">
<div class="panel-name">Dicionário</div>

**BASES INDIC_FUND E INDIC_MEDIO**

- **Indic:** Indicadores

- **Fund:** Ensino Fundamental

- **Medio:** Ensino Médio

1. `id_municipio`: código do IBGE de identificação do município

2. `tx_aband`: taxa de abandono escolar média do município 

3. `hrs_aula`: média das horas de aula por município

4. `tdi`: taxa de distorção idade-série

  - proproção de alunos com mais de 2 anos de atraso escolar

</div>
<div class="panel">
<div class="panel-name">PIB</div>

.tiny[
```{r}
head(pib_pop, n = 5)
```
]

<br>
<br>
<br>
<br>
<br>
<br>
<br>

.right[<span style='font-size:80%'>O Pib <i>per capita</i> será calculado depois.</span>]

</div>
<div class="panel">
<div class="panel-name">Dicionário</div>

**PIB**

1. `id_municipio`: código do IBGE de identificação do município

2. `pib`: pib dos municípios em 2020

3. `populacao`: população dos municípios em 2020

<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>

.right[<span style='font-size:80%'>O Pib <i>per capita</i> será calculado depois.</span>]

</div>
</div>

<!-- <div class="my-footer">O Pib <i>per capita</i> será calculado depois.</div> -->

---

### Padronizando as bases de dados

<div class="panelset">
<div class="panel">
<div class="panel-name">Ideb (F)</div>

.tiny[
```{r}
ideb_fundamental <- ideb_fund %>% 
  select(id_municipio, tx_aprov, ideb)

ideb_fundamental
```
]

</div>
<div class="panel">
<div class="panel-name">Ideb (M)</div>

.tiny[
```{r}
ideb_medio <- ideb_medio %>% 
  select(id_municipio, tx_aprov, ideb)

ideb_medio
```
]

</div>
<div class="panel">
<div class="panel-name">Indicador (F)</div>

.tiny[
```{r}
indicadores_fundamental <- indic_fund %>% 
  select(id_municipio, tx_aband, hrs_aula, tdi)

indicadores_fundamental
```
]

</div>
<div class="panel">
<div class="panel-name">Indicador (M)</div>

.tiny[
```{r}
indicadores_medio <- indic_medio %>% 
  select(id_municipio, tx_aband, hrs_aula, tdi)

indicadores_medio
```
]

</div>
<div class="panel">
<div class="panel-name">PIB</div>

.tiny[
```{r}
pib_pc <- pib_pop %>% 
  mutate(pib_pc = pib/populacao) %>% # cria a coluna pib_pc
  select(id_municipio, pib_pc)  
  
pib_pc
```
]

</div>
</div>

---

### Juntando as bases de dados: Fundamental

<div class="panelset">
<div class="panel">
<div class="panel-name">left-join seguidos</div>

.tiny[
```{r}
fund <- left_join(
  ideb_fundamental, indicadores_fundamental, by = "id_municipio"
) %>% left_join(pib_pc, by = "id_municipio")

fund
```
]

</div>
<div class="panel">
<div class="panel-name">reduce</div>

.tiny[
```{r}
# programação funcional - é o mais indicado!
fund <- list(ideb_fundamental, indicadores_fundamental, pib_pc) %>% 
  reduce(left_join)

fund
```
]

</div>
</div>

---

### Análises Descritivas: Fundamental

<div class="panelset">
<div class="panel">
<div class="panel-name">resumo</div>

.tiny[
```{r}
summary(fund)
```
]

</div>
<div class="panel">
<div class="panel-name">histogram</div>

.tiny[
```{r}
fund %>% 
  ggplot() +
  aes(x = ideb) +
  geom_histogram() #<<
```
]

</div>
<div class="panel">
<div class="panel-name">bloxplot (x)</div>

.tiny[
```{r}
fund %>% 
  ggplot() +
  aes(x = ideb) + #<<
  geom_boxplot() #<<
```
]

</div>
<div class="panel">
<div class="panel-name">bloxplot (y)</div>

.pull-left[
.tiny[
```{r eval=FALSE}
fund %>% 
  ggplot() +
  aes(y = ideb) + #<<
  geom_boxplot() #<<
```
]
]

.pull-right[
.tiny[
```{r echo=FALSE, fig.height=4, fig.width=3.5, fig.align='center'}
fund %>% 
  ggplot() +
  aes(y = ideb) +
  geom_boxplot()
```
]
]

</div>
</div>

---

### Regressão Linear: Fundamental

**Será que a taxa de distorção idade-série e a taxa de abandono escolar possuem relação positiva?**
<!-- **Será que a `tdi` e a `tx_aband` possuem relação positiva?** -->


<div class="panelset">
<div class="panel">
<div class="panel-name">sem linha de tendência</div>

.tiny[
```{r}
fund %>% 
  ggplot(aes(x = tdi, y = tx_aband)) +
  geom_point() 
```
]

</div>
<div class="panel">
<div class="panel-name">com linha de tendência</div>

.tiny[
```{r fig.height=3}
fund %>% 
  ggplot(aes(x = tdi, y = tx_aband)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) #<<
```
]

</div>
</div>

---

**Será que a taxa de distorção idade-série e a taxa de abandono escolar possuem relação positiva?**
<!-- **Será que a `tdi` e a `tx_aband` possuem relação positiva?** -->

.tiny[
```{r}
modelo1 <- lm(tx_aband ~ tdi, data = fund)
summary(modelo1)
```
]

---

**Será que a taxa de distorção idade-série e a taxa de abandono escolar possuem relação positiva?**
<!-- **Será que a `tdi` e a `tx_aband` possuem relação positiva?** -->

A relação entre a taxa de distorção idade-série (`tdi`) e a taxa de abandono escolar (`tx_aband`) é positiva, mas não parece ser muito forte. A variável `tdi` tem significância estatística muito próxima a zero. E o R<mathml><mi>&#178;</mi></mathml> é igual a 0.3074, indicando que `r 0.3074*100`% da equação é explicada pela variável explicativa.

<br>

$$
\text{tx_aband} = -0.568 + 0.124 \cdot \text{tdi}   
$$
<br>

**Interpretação:** 

O aumento de 1 p.p. na taxa de distorção idade-série (`tdi`) retorna um aumento de 0.12 p.p. na taxa de abandono escolar (`tx_aband`).

Percebe-se que quanto maior for a distorção idade-série (`tdi`), maiores serão as taxas de abandono escolar (`tx_aband`).

---

**Qual a relação entre `tdi`, `tx_aprov`, `hrs_aula` e a `tx_aband`?**

.tiny[
```{r}
modelo2 <- lm(tx_aband ~ tdi + tx_aprov + hrs_aula, data = fund)
summary(modelo2)
```
]

---

**Qual a relação entre `tdi`, `tx_aprov`, `hrs_aula` e a `tx_aband`?**

<span style='font-size:80%'>A taxa de distorção idade-série (`dti`) e as horas-aula (`hrs_aula`) possuem relação positiva em relação à taxa de abandono (`tx_aband`), sendo a primeira variável com significância estatística muito próxima de zero, ou seja, significativa estatisticamente; e a segunda variável significativa estatisticamente para 10%. A taxa de aprovação (`tx_aprov`) apresenta uma relação negativa com a taxa de abandono (`tx_aband`), tendo significância estatística próxima a zero. O R<mathml><mi>&#178;</mi></mathml> é igual a 0.525, ou seja, `r 0.525*100`% da equação é explicada pelos parâmetros. E o Teste F é estatisticamente significativo, indicando que todos os parâmetros são conjuntamente significativos.</span>


$$
\text{tx_aband} = 22.093 + 0.059 \cdot \text{tdi} - 0.228 \cdot \text{tx_aprov} + 0.040 \cdot \text{hrs_aula}
$$

**Interpretação:**

<span style='font-size:80%'>Um aumento de 1 p.p. na taxa de distorção idade-série (`tdi`) gera um aumento de 0.059 p.p. na taxa de abandono escolar (`tx_aband`), <i>ceteris paribus</i>.</span>

<span style='font-size:80%'>Um aumento de 1 p.p. na taxa de aprovação (`tx_aprov`) resulta em uma redução de 0.228 p.p. na taxa de abandono (`tx_aband`), <i>ceteris paribus</i>.</span> 

<span style='font-size:80%'>Um aumento de 1 hora-aula (`hrs_aula`) resulta em um aumento de 0.04 p.p. na taxa de abandono escolar (`tx_aband`), <i>ceteris paribus</i>.</span> 

---

**Qual a relação entre `tdi`, `tx_aprov`, `pib_pc` e a `tx_aband`?**

.tiny[
```{r}
modelo3 <- lm(tx_aband ~ tdi + tx_aprov + pib_pc, data = fund)
summary(modelo3)
```
]

---

**Qual a relação entre `tdi`, `tx_aprov`, `pib_pc` e a `tx_aband`?**

<span style='font-size:80%'>Enquanto a taxa de distorção idade-série (`tdi`) tem uma relação positiva com a taxa de abandono escola (`tx_aband`), as variáveis de taxa de aprovação escolar (`tx_aprov`) e de Pib <i>per capita</i> possuem uma relação negativa. Todos os parâmetros são estatisticamente significantes. O R<mathml><mi>&#178;</mi></mathml> é igual a 0.5293, indicando que `r 0.5293*100`% da equação é explicada pelo modelo. O Teste F tem <i>p-valor</i> muito próximo a zero, ou seja, todos os parâmetros são conjuntamente significativos.</span>


$$
\text{tx_aband} = 22.438 + 0.056 \cdot \text{tdi} - 0.229 \cdot \text{tx_aprov} - 0.000004 \cdot \text{pib_pc}
$$

<br>

**Interpretação:**

<span style='font-size:80%'>O pib <i>per capita</i> (`pib_pc`) possui uma relação negativa com a taxa de abandono escolar (`tx_aband`), isto é, quanto maior for o pib <i>per capita</i> do município, menor será a taxa de abandono escolar.</span>

<span style='font-size:80%'>O aumento de 1 Real no pib <i>per capita</i> gera uma queda de 0.000004 p.p. na taxa de abandono escolar. Convertendo o valor do `pib_pc` para 10 mil Reais, isso corresponde a um decréscimo de 0.04 p.p. na taxa de abandono escolar.</span>

<span style='font-size:80%'>Isso indica que municípios mais ricos possuem valores consideravelmente menores de abandono escolar quando comparados com municípios mais pobres, <i>ceteris paribus</i>.</span>

---

### Juntando as bases de dados: Médio

<div class="panelset">
<div class="panel">
<div class="panel-name">left-join seguidos</div>

.tiny[
```{r}
medio <- left_join(
  ideb_medio, indicadores_medio, by = "id_municipio"
) %>% left_join(pib_pc, by = "id_municipio")

medio
```
]

</div>
<div class="panel">
<div class="panel-name">reduce</div>

.tiny[
```{r}
# programação funcional - é o mais indicado! 
medio <- list(ideb_medio, indicadores_medio, pib_pc) %>% 
  reduce(left_join)

medio
```
]

</div>
</div>

---

### Análises Descritivas: Médio

<div class="panelset">
<div class="panel">
<div class="panel-name">resumo</div>

.tiny[
```{r}
summary(medio)
```
]

</div>
<div class="panel">
<div class="panel-name">histogram</div>

.tiny[
```{r}
medio %>% 
  ggplot() +
  aes(x = ideb) +
  geom_histogram() #<<
```
]

</div>
<div class="panel">
<div class="panel-name">bloxplot (x)</div>

.tiny[
```{r}
medio %>% 
  ggplot() +
  aes(x = ideb) + #<<
  geom_boxplot() #<<
```
]

</div>
<div class="panel">
<div class="panel-name">bloxplot (y)</div>

.pull-left[
.tiny[
```{r eval=FALSE}
medio %>% 
  ggplot() +
  aes(y = ideb) + #<<
  geom_boxplot() #<<
```
]
]

.pull-right[
.tiny[
```{r echo=FALSE, fig.height=4, fig.width=3.5, fig.align='center'}
medio %>% 
  ggplot() +
  aes(y = ideb) + 
  geom_boxplot()
```
]
]

</div>
</div>

---

### Regressão Linear: Médio

**Qual é a relação entre o `ideb` e a `tx_aband`?**

<div class="panelset">
<div class="panel">
<div class="panel-name">sem linha de tendência</div>

.tiny[
```{r}
medio %>% 
  ggplot(aes(x = ideb, y = tx_aband)) +
  geom_point()
```
]

</div>
<div class="panel">
<div class="panel-name">com linha de tendência</div>

.tiny[
```{r fig.height=3}
medio %>% 
  ggplot(aes(x = ideb, y = tx_aband)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)
```
]

</div>
</div>

<div class="my-footer">Quanto maior for o ideb, menor será a taxa de abandono. Há uma relação forte com a queda na taxa de abandono.</a></div>

---

**Qual a relação entre a `tx_aprov` e a `tx_aband`?**

<br>

<div class="panelset">
<div class="panel">
<div class="panel-name">sem linha de tendência</div>

.tiny[
```{r}
medio %>% 
  ggplot(aes(x = tx_aprov, y = tx_aband)) +
  geom_point() 
```
]

</div>
<div class="panel">
<div class="panel-name">com linha de tendência</div>

.tiny[
```{r}
medio %>% 
  ggplot(aes(x = tx_aprov, y = tx_aband)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)
```
]

</div>
</div>

---

**Qual a relação entre a `hrs_aula` e a `tx_aband`?**

<br>

<div class="panelset">
<div class="panel">
<div class="panel-name">sem linha de tendência</div>

.tiny[
```{r}
medio %>% 
  ggplot(aes(x = hrs_aula, y = tx_aband)) +
  geom_point() 
```
]

</div>
<div class="panel">
<div class="panel-name">com linha de tendência</div>

.tiny[
```{r}
medio %>% 
  ggplot(aes(x = hrs_aula, y = tx_aband)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)
```
]

</div>
</div>


---

**Qual a relação entre `tdi`, `hrs_aula`, `pib_pc` e a `tx_aband`?**

.tiny[
```{r}
modelo4 <- lm(tx_aband ~ tx_aprov + tdi + hrs_aula + pib_pc,data=medio)
summary(modelo4)
```
]

---

**Qual a relação entre `tdi`, `hrs_aula`, `pib_pc` e a `tx_aband`?**

<br>

$$
\text{tx_aband} = 49.94 - 0.504 \text{tx_aprov} + 0.093 \text{tdi} - 0.136 \text{hrs_aula} - 0.00001\text{pibpc}
$$

**Interpretação:**

<span style='font-size:80%'>O aumento de 1 p.p. na taxa de aprovação (`tx_aprov`) reduz em 0.50 p.p. a taxa de abandono escolar (`tx_aband`), <i>ceteris paribus</i>.</span> 

<span style='font-size:80%'>O aumento de 1 p.p. na taxa de distorção idade-série (`tdi`) aumenta em 0.082 p.p. a taxa de abandono escolar (`tx_aband`), <i>ceteris paribus</i>.</span>

<span style='font-size:80%'>O aumento de 1 hora-aula (`hrs_aula`) diminui em 0.136 p.p. a taxa de abandono escolar (`tx_aband`), <i>ceteris paribus</i>.</span>

<span style='font-size:80%'>O aumento de 1 Real no pib <i>per capita</i> gera uma queda de 0.00001 p.p. na taxa de abandono escolar, <i>ceteris paribus</i>. Convertendo o valor do `pib_pc` para 10 mil Reais, isso corresponde a uma redução de 0.1 p.p. na taxa de abandono escolar, <i>ceteris paribus</i>.</span>

<span style='font-size:80%'>Quanto mais tempo o adolescente passa na escola, menor é a queda na taxa de abandono escolar. As taxas de abandono no ensino médio são maiores quando comparado com o ensino fundamental. O pib <i>per capita</i> afeta mais os dados do ensino médio do que do ensino fundamental.</span>

---

### <span style='color:#34a15a'>BASE DOS DADOS</span>

<span style='color:#34a15a'><b>Importando a base da BigQuery para o R:</b></span>

.tiny[
```{r}
# install.packages("basedosdados")

library(basedosdados)

# faz a ligação entre o R e a BigQuery do Google
set_billing_id("ID-PROJECT") 
```
]

.tiny[
```{r include=FALSE}
set_billing_id("luisagisele-ufsm")
```
]

.tiny[
```{sql eval = FALSE, include = TRUE}
# sem filtro
"SELECT coluna1, coluna2, coluna3,
coluna4 AS apelido_da_coluna
FROM `tabela`" 

# com filtro
"SELECT coluna1, coluna2, coluna3,
coluna4 AS apelido_da_coluna
FROM `tabela`
WHERE coluna1 = valor AND coluna2 = valor"
```
]

---

class: inverse center middle

# Atlas do Desenvolvimento Humano

---

### Atlas do Desenvolvimento Humano

<span style='font-size:80%'; 'text-align:justify'>A plataforma <b>Atlas do Desenvolvimento Humano no Brasil</b> possui o objetivo de viabilizar, de maneira descomplicada, o acesso amplo às diversas informações estatísticas que constatam características e desigualdades sociais no território brasileiro, sendo uma das maiores ferramentas de divulgação de informações sobre o desenvolvimento humano no país.</span>

<span style='font-size:80%'; 'text-align:justify'>O <b>Atlas Brasil</b> é produto da parceria entre o Programa das Nações Unidas para o Desenvolvimento (PNUD), o Instituto de Pesquisa Econômica Aplicada (IPEA) e a Fundação João Pinheiro (FJP). Criado com a finalidade de apresentar o Índice de Desenvolvimemto Humano Municipal (IDHM), o Atlas disponibiliza, também, mais de 330 indicadores que percorrem temas como educação, saúde, habitação, renda, trabalho, vulnerabilidade social, meio ambiente e participação política, para os 5.570 municípios, cinco macrorregiões, 27 Unidades da Federação (UFs), 21 regiões metropolitanas (RMs), três regiões integradas de desenvolvimento (RIDEs) e aproximadamente 17.000 unidades de desenvolvimento humano (UDHs) ou “bairros”, sendo estes as menores territorialidades brasileiras que dialogam diretamente com a realidade do cidadão.</span>

<span style='font-size:80%'; 'text-align:justify'>O projeto continua, produzindo indicadores desagregados por grupos sociais - mulheres, homens, negros, brancos, populações rurais e urbanas. Além dos Censos Demográficos de 1991, 2000 e 2010, incorpora novas fontes de dados, tais como a Pesquisa Nacional por Amostra de Domicício (PNAD) e informações de registros cadastrais e administrativos.</span>

<div class="my-header">Fonte: <a href="http://www.atlasbrasil.org.br/">Atlas Brasil</a></div>

---

### Importando os dados 

.tiny[
```{r}
adh <-
"SELECT id_municipio, ano, mortalidade_1, mortalidade_5, 
taxa_freq_liquida_pre, indice_gini,prop_pobreza_extrema_criancas, 
prop_pobreza_criancas, prop_vulner_pobreza_criancas, 
taxa_agua_esgoto_inadequados, taxa_criancas_fora_escola_4_5
FROM `basedosdados.mundo_onu_adh.municipio`" %>%
  read_sql()

glimpse(adh)
```
]

---

**Será que a mortalidade infantil de crianças (até 1 ano) se relaciona com a taxa de água e esgoto inadequados?**

<div class="panelset">
<div class="panel">
<div class="panel-name">sem linha de tendência</div>

.tiny[
```{r}
adh %>% 
  ggplot() +
  aes(x = taxa_agua_esgoto_inadequados, y = mortalidade_1) +
  geom_point() 
```
]

</div>
<div class="panel">
<div class="panel-name">com linha de tendência</div>

.tiny[
```{r}
adh %>% 
  ggplot() +
  aes(x = taxa_agua_esgoto_inadequados, y = mortalidade_1) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)
```
]

</div>
</div>

<div class="my-footer">Apesar dos pontos estarem espalhados no gráfico, é possível perceber uma relação positiva entre as variáveis.</div>

---

**Será que a mortalidade infantil de crianças (até 1 ano) se relaciona com a taxa de água e esgoto inadequados?**

.tiny[
```{r}
modelo5 <- lm(mortalidade_1 ~ taxa_agua_esgoto_inadequados, data=adh)
summary(modelo5)
```
]

---

**Será que a mortalidade infantil de crianças (até 1 ano) se relaciona com a taxa de água e esgoto inadequados?**

A taxa de pessoas em domicílios com abastecimento de água e esgoto sanitário inadequados (`taxa_agua_esgoto_inadequados`) se relaciona positivamente com a mortalidade de crianças com até um (1) ano de idade (`mortalidade_1`). É observado que a variável independente (`taxa_agua_esgoto_inadequados`) possui uma significância estatística muito próxima à zero, sendo significativa estatisticamente. O R<mathml><mi>&#178;</mi></mathml> é igual a 0.3976, ou seja, `r 0.3976*100`% da equação é explicada pelo modelo.

<br>

$$
\text{mortalidade_1} = 24.099 + 0.689 \cdot \text{taxa_agua_esgoto_inadequados}
$$

<br>

**Interpretação:**

Um aumento de 1 p.p. na taxa de água e esgoto inadequados (`taxa_agua_esgoto_inadequados`) gera um aumento de 0.689 p.p. na mortalidade de crianças com até um (1) ano de idade (`mortalidade_1`). 

---

**Relação entre a proporção de extrema pobreza em crianças e a mortalidade infantil (até 5 anos)**

<div class="panelset">
<div class="panel">
<div class="panel-name">sem linha de tendência</div>

.tiny[
```{r}
adh %>% 
  ggplot() +
  aes(x = prop_pobreza_extrema_criancas, y = mortalidade_5) +
  geom_point() 
```
]

</div>
<div class="panel">
<div class="panel-name">com linha de tendência</div>

.tiny[
```{r}
adh %>% 
  ggplot() +
  aes(x = prop_pobreza_extrema_criancas, y = mortalidade_5) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)
```
]

</div>
</div>

<div class="my-footer">É possível perceber uma relação positiva entre a proporção de extrema pobreza em crianças e a mortalidade infantil.</div>

---

**Relação entre a proporção de extrema pobreza em crianças e a mortalidade infantil (até 5 anos)**

.tiny[
```{r}
modelo6 <- lm(mortalidade_5 ~ prop_pobreza_extrema_criancas, data=adh)
summary(modelo6)
```
]

---

**Relação entre a proporção de extrema pobreza em crianças e a mortalidade infantil (até 5 anos)**

A proporção de crianças extremamente pobres (`prop_pobreza_extrema_criancas`) se relaciona positivamente com a mortalidade de crianças com até cinco (5) anos de idade (`mortalidade_5`). A variável dependente (`prop_pobreza_extrema_criancas`) apresenta uma significância estatística muito próxima à zero, sendo, assim, significativa estatisticamente. O R<mathml><mi>&#178;</mi></mathml> é igual a 0.6447, ou seja, `r 0.6447*100`% da equação é explicada pelo modelo linear.

<br>

$$
\text{mortalidade_5} = 13.712 + 0.954 \cdot \text{prop_pobreza_extrema_criancas}
$$

<br>

**Interpretação:**

Um aumento de 1 p.p. na proporção de crianças extremamente pobres (`prop_pobreza_extrema_criancas`) acarreta um aumento de 0.954 p.p. na mortalidade de crianças com até cinco (5) anos de idade (`mortalidade_5`).

---

<!-- **Em relação ao slide anterior, será que há um padrão regional?** -->

**Será que há um padrão regional para a relação entre a  proporção de extrema pobreza em crianças e a mortalidade infantil (até 5 anos)?**

<span style='font-size:85%'>Primeiro é preciso baixar os dados referentes as regiões do Brasil e, depois, fazer um `left_join()` com a base `adh`. Então, a base `dados` tem os dados de `adh` e os dados de `regiao`.</span>

.tiny[
```{r}
regiao <- "SELECT id_municipio, nome_regiao 
FROM `basedosdados.br_bd_diretorios_brasil.municipio`" %>% 
  read_sql()

dados <- left_join(adh, regiao, by = "id_municipio")
```
]

<!-- <span style='font-size:80%'>Agora, a base `dados` tem os dados de `adh` e os dados de `regiao`.</span> -->

.tiny[
```{r echo=FALSE}
glimpse(dados)
```
]

---

<!-- **Em relação ao slide anterior, será que há um padrão regional?** -->

**Será que há um padrão regional para a relação entre a proporção de extrema pobreza em crianças e a mortalidade infantil (até 5 anos)?**

<div class="panelset">
<div class="panel">
<div class="panel-name">sem linha de tendência</div>

.tiny[
```{r fig.height=3}
dados %>% 
  ggplot() +
  aes(x = prop_pobreza_extrema_criancas, y = mortalidade_5, 
      color = nome_regiao) +
  geom_point() +
  scale_color_brewer(palette = "Set2")
```
]

</div>
<div class="panel">
<div class="panel-name">com linha de tendência</div>

.tiny[
```{r fig.height=3}
dados %>% 
  ggplot() +
  aes(x = prop_pobreza_extrema_criancas, y = mortalidade_5, 
      color = nome_regiao) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  scale_color_brewer(palette = "Set2")
```
]

</div>
</div>

<div class="my-footer">Municípios do Norte e Nordeste têm altos índices de mortalidade infantil até 5 anos e de pobreza extrema entre as crianças.</div>

---

**Relação entre crianças fora da escola (4 e 5 anos) e a proporção de crianças na extrema pobreza**

.tiny[
```{r fig.height=2.7}
dados %>% 
  ggplot(aes(x = prop_pobreza_extrema_criancas, 
             y = taxa_criancas_fora_escola_4_5, color = nome_regiao)) +
  geom_point(alpha = 0.5) +
  scale_color_brewer(palette = "Set2") +
  # cria uma linha de tendência para cada região do Brasil
  geom_smooth(method = "lm", se = FALSE)
```
]

<span style='font-size:90%'>É possível ver que algumas regiões têm uma relação mais inclinada que outras. Por exemplo, um aumento na taxa de pobreza extrema das crianças gera aumentos muito mais fortes na taxa de crianças fora da escola na Região Sul do que no Nordeste.</span>

---

**Média da Mortalidade Infantil (até 1 ano) por Região Brasileira em 1991, 2000 e 2010**

<div class="panelset">
<div class="panel">
<div class="panel-name">Gráfico de Pontos</div>

.tiny[
```{r}
dados %>% 
  group_by(ano, nome_regiao) %>% 
  summarise(media = mean(mortalidade_1, na.rm = TRUE)) %>% 
  ggplot() +
  aes(x = media, y = nome_regiao, color = as.factor(ano)) +
  geom_point(size = 4)
```
]

</div>
<div class="panel">
<div class="panel-name">Gráfico de Barras</div>

.tiny[
```{r}
dados %>% 
  group_by(ano, nome_regiao) %>% 
  summarise(media = mean(mortalidade_1, na.rm = TRUE)) %>% 
  ggplot() +
  aes(x = nome_regiao, y = media, fill = as.factor(ano)) +
  # indica como as barras devem ser posicionadas
  geom_bar(stat = "identity", position = "dodge")
```
]

</div>
<div class="panel">
<div class="panel-name">Interpretação</div>

.tiny[
```{r include=FALSE}
med_mort_inf_red_reg_bras <- dados %>% 
  group_by(ano, nome_regiao) %>% 
  summarise(media = mean(mortalidade_1, na.rm = TRUE)) |> 
  group_by(nome_regiao) |> 
  mutate(reducao = -(media - lag(media)))
```
]

<span style='font-size:90%'; 'text-align:justify'>Os gráficos apresentam duas formas diferentes de apresentar a média da Mortalidade Infantil para crianças com até um (1) ano de idade por região brasileira em três diferentes anos de observação (1991, 2000 e 2010). Em ambos, é possível identificar que os níveis de Mortalidade em crianças com até cinco (5) anos diminuiu ao longo dos anos observados para todas as regiões brasileiras. </span>

<ul>
<li><span style='font-size:90%'; 'text-align:justify'> Na <b>Região Centro-Oeste</b>, a redução foi de `r round(med_mort_inf_red_reg_bras$reducao[6], 2)`% entre os anos de 1991 e 2000; e `r round(med_mort_inf_red_reg_bras$reducao[11], 2)`% entre 2000 e 2010.</span></li>

<li><span style='font-size:90%'; 'text-align:justify'> Na <b>Região Nordeste</b>, a redução foi de `r round(med_mort_inf_red_reg_bras$reducao[7], 2)`% entre 1991 e 2000; e `r round(med_mort_inf_red_reg_bras$reducao[12], 2)`% entre os anos de 2000 e 2010.</span></li>

<li><span style='font-size:90%'; 'text-align:justify'> Na <b>Região Norte</b>, a redução foi de `r round(med_mort_inf_red_reg_bras$reducao[8], 2)`% de 1991 para 2000; e `r round(med_mort_inf_red_reg_bras$reducao[13], 2)`% de 2000 para 2010.</span></li>

<li><span style='font-size:90%'; 'text-align:justify'> Na <b>Região Sudeste</b>, a redução foi de `r round(med_mort_inf_red_reg_bras$reducao[9], 2)`% entre 1991 e 2000; e `r round(med_mort_inf_red_reg_bras$reducao[14], 2)`% entre 2000 e 2010.</span></li>

<li><span style='font-size:90%'; 'text-align:justify'> Na <b>Região Sul</b>, a redução foi de `r round(med_mort_inf_red_reg_bras$reducao[10], 2)`% entre os anos de 1991 e 2000; e `r round(med_mort_inf_red_reg_bras$reducao[15], 2)`% entre os anos de 2000 e 2010.</span></li>
</ul>

</div>
</div>

---

### Mapas

Para criar mapas, é necessário realizar o download dos dados espaciais através do pacote [{geobr}](https://github.com/ipeaGIT/geobr). E, depois, unir as bases com os dados espaciais dos municípios e com os dados do `adh`.

.tiny[
```{r eval=FALSE}
muni <- geobr::read_municipality(year = 2010) %>%
  mutate(code_muni = as.character(code_muni))

muni_dados <- left_join(
  muni, dados, by = c("code_muni" = "id_municipio")
)
```
]

A nova base possui as seguintes colunas:

.tiny[
```{r echo=FALSE}
muni <- geobr::read_municipality(year = 2010, showProgress = FALSE) %>%
  mutate(code_muni = as.character(code_muni))

muni_dados <- left_join(muni, dados, by = c("code_muni" = "id_municipio"))

names(muni_dados)
```
]

---

<div class="panelset">
<div class="panel">
<div class="panel-name">Mortalidade (até 1 ano)</div>

.tiny[
```{r}
muni_dados %>% 
  filter(ano == 2010) %>% 
  ggplot() +
  aes(geometry = geom, fill = mortalidade_1) +
  geom_sf(color = NA) +
  scale_fill_viridis_c(na.value = "grey90")
```
]

</div>
<div class="panel">
<div class="panel-name">Pobreza Extrema Crianças</div>

.tiny[
```{r}
muni_dados %>%
  filter(ano == 2010) %>%
  ggplot() +
  aes(geometry = geom, fill = prop_pobreza_extrema_criancas) +
  geom_sf(color = NA) +
  scale_fill_viridis_c(na.value = "grey90")
```
]

</div>
<div class="panel">
<div class="panel-name">Tx. Crianças Fora da Escola</div>

.tiny[
```{r}
muni_dados %>%
  filter(ano == 2010) %>%
  ggplot() +
  aes(geometry = geom, fill = taxa_criancas_fora_escola_4_5) +
  geom_sf(color = NA) +
  scale_fill_viridis_c(na.value = "grey90")
```
]

</div>
<div class="panel">
<div class="panel-name">Tx. Água/Esgoto Inadequados</div>

.tiny[
```{r}
muni_dados %>%
  filter(ano == 2010) %>%
  ggplot() +
  aes(geometry = geom, fill = taxa_agua_esgoto_inadequados) +
  geom_sf(color = NA) +
  scale_fill_viridis_c(na.value = "grey90")
```
]

</div>
</div>

---

class: inverse center middle

# Pacote [`{wooldridge}`](https://github.com/JustinMShea/wooldridge/)

<br>
<br>

.right[<span style='font-size:80%'>Este pacote contém a documentação completa <br>para cada conjunto e todos os dados <br> utilizados no livro <span style='color:#f58634'><b>Introdução à Econometria</b></span> <br> de Jeffrey M. Wooldridge</span>]

---

### Dado utilizado: &nbsp; `wage`

```{r include=FALSE}
wage <- wooldridge::wage1
```

<span style='font-size:80%'>Estes dados correspondem à Pesquisa Populacional de 1976, coletados por Henry Farver e Jeffrey Wooldridge quando eram colegam no [MIT](https://www.mit.edu/) em 1988. O conjunto é composto por 526 observações e 24 variáveis, tais como: *`r knitr::combine_words(names(wage), and = " e ")`*. </span>

.tiny[
```{r}
wage <- wooldridge::wage1
```
]

```{r echo=FALSE}
glimpse(wage)
``` 

<div class="my-header">Fonte: <a href="https://justinmshea.github.io/wooldridge/reference/wage1.html#source">wage1 • wooldridge </a></div>

---

**A relação entre educação e salário**

<div class="panelset">
<div class="panel">
<div class="panel-name">Regressão</div>

.tiny[
```{r}
mod <- lm(wage ~ educ, data = wage)
summary(mod)
```
]

</div>
<div class="panel">
<div class="panel-name">Interpretação</div>

A relação entre os anos de estudo (`educ`) e o salário médio por hora (`wage`) é positivamente inclinada. O parâmetro de `educ` é estatisticamente significativo. E o R<mathml><mi>&#178;</mi></mathml> é igual a 0.1648, isto é, `r round(0.1648*100, 2)`% da equação é explicada pela variável independente (`educ`).

<br>

$$
\text{wage} = -0.905 + 0.541 \cdot \text{educ}
$$

<br>

**Interpretação:**

A cada um 1 ano que aumenta a educação (`educ`), o salário do indivíduo aumenta (em média) 0.54 doláres.

</div>
<div class="panel">
<div class="panel-name">Gráfico</div>

.tiny[
```{r}
wage %>%
  ggplot() +
  aes(x = educ, y = wage) +
  geom_point() +
  geom_smooth(method = 'lm', se = FALSE)
```
]

</div>
</div>

<div class="my-header">Fonte: <a href="https://justinmshea.github.io/wooldridge/reference/wage1.html#source">wage1 • wooldridge </a></div>

---

**A relação entre educação e log-salário**

<div class="panelset">
<div class="panel">
<div class="panel-name">Regressão</div>

.tiny[
```{r}
mod1 <- lm(lwage ~ educ, data = wage)
summary(mod1)
```
]

</div>
<div class="panel">
<div class="panel-name">Interpretação</div>

A relação entre os anos de estudo (`educ`) e o log-salário é positivamente inclinado. A variável de educação (`educ`) é significativa estatisticamente, uma vez que possui significância estatística muito próxima à zero. E o R<mathml><mi>&#178;</mi></mathml> é igual a 0.1858, ou seja, `r round(0.1858*100, 2)`% da equação é explicada pela variável independente (`educ`).

<br>

<!-- LWAGE = 0.58 + 0.0827EDUC -->
<!-- a cada 1 ano de educacao, o salário aumenta 8.27% (beta * 100) -->

$$
\text{lwage} = 0.584 + 0.083 \cdot \text{educ}
$$

<br>

**Interpretação:**

A cada um (1) ano que aumenta a educação (`educ`), o salário do indivíduo aumenta em 8.30% (<mathml><mi>&#x03B2;</mi></mathml> • 100).

</div>
<div class="panel">
<div class="panel-name">Gráfico</div>

.tiny[
```{r}
ggplot(wage) +
  aes(x = educ, y = lwage) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)
```
]

</div>
</div>

<div class="my-header">Fonte: <a href="https://justinmshea.github.io/wooldridge/reference/wage1.html#source">wage1 • wooldridge </a></div>

---

<!-- **mincer: o salario da pessoa pode ser estimado por meio da sua experiencia e da sua educacao** -->

**Mincer: o salário é estimado por meio da sua experiência e educação**

<div class="panelset">
<div class="panel">
<div class="panel-name">Regressão</div>

.tiny[
```{r}
mincer <- lm(lwage ~ educ + exper, data = wage)
summary(mincer)
```
]
</div>
<div class="panel">
<div class="panel-name">Interpretação</div>

<!-- lwage = 0.2169 + 0.0979 educ + 0.010 exper -->
<!-- aumento de 1 ano em educacao gera um aumento de 9,79% salario -->

Os anos de estudo e de experiência possuem relação positiva com o log-salário. Ambas variáveis independentes, `educ` e `exper` têm significância estatística muito próxima à zero. Cerca de `r round(0.2493*100, 2)`% da equação é explicada pelo modelo, uma vez que o R<mathml><mi>&#178;</mi></mathml> é igual a 0.2493.

<br>

$$
\text{lwage} = 0.217 + 0.098 \cdot \text{educ} + 0.010 \cdot \text{exper}
$$

<br>

**Interpretação:**

O aumento de 1 ano de estudo (`educ`) gera um aumento de, aproximadamente, `r round(mincer$coefficients[2]*100, 2)`% do salário, *ceteris paribus*.

O aumento de 1 ano de experiêcia (`exper`) resulta em um aumento de `r round(mincer$coefficients[3]*100,2)`% do salário, *ceteris paribus*.

</div>
<div class="panel">
<div class="panel-name">Gráfico</div>
```{r}
ggplot(wage) +
  aes(x = educ, y = lwage) +
  geom_point(aes(color = exper), alpha = 0.7) +
  scale_color_viridis_c() +
  geom_smooth(method = "lm", se = FALSE)
```

</div>
</div>

<div class="my-header">Fonte: <a href="https://justinmshea.github.io/wooldridge/reference/wage1.html#source">wage1 • wooldridge </a></div>

---

<!-- **Relação entre salário, educação e experiência ao longo da vida** -->

<div class="panelset">
<div class="panel">
<div class="panel-name">Regressão</div>

.tiny[
```{r}
mincer2 <- lm(lwage ~ educ + exper + expersq, data = wage)
summary(mincer2)
```
]

</div>
<div class="panel">
<div class="panel-name">Interpretação</div>

<!-- conforme a experiencia aumenta, ela afeta negativamente o salario da pessoa -->
<!-- lwage = 0.12 + 0.09educ + 0.041exper - 0.00071expersq -->

**Mincer: Relação entre salário, educação e experiência ao longo da vida**

<br>

$$
\text{lwage} = 0.128 + 0.090 \cdot \text{educ} + 0.041 \cdot \text{exper} - 0.0007 \cdot \text{expersq}
$$

<br>

Os anos de estudo (`educ`) e de experiência (`exper`) possuem relação positiva com o log-salário. Entretanto, como é esperado, ao longo do tempo, conforme o indivíduo envelhece e a sua experiência (`expersq`) aumenta, o log-salário (`lwage`) aumenta até atingir um certo ponto e, depois, começa a diminuir. Todos os parâmetros são estatisticamente significantes, sendo muito próximos a zero. O Teste F tem significância estatística (tem *p-valor* próximo a zero), indicando que os parâmetros são conjuntamente significativos. O R<mathml><mi>&#178;</mi></mathml> é igual a 0.3003, indicando que a equação é explicada por `r round(0.3003*100, 2)`% das variáveis explicativas.   

</div>
<div class="panel">
<div class="panel-name">Gráfico</div>

.tiny[
```{r}
ggplot(wage) +
  aes(x = educ, y = lwage) +
  geom_point(aes(color = exper, size = expersq), alpha = 0.7) +
  scale_color_viridis_c() +
  geom_smooth(method = "lm", se = FALSE)
```
]

</div>
</div>

<div class="my-header">Fonte: <a href="https://justinmshea.github.io/wooldridge/reference/wage1.html#source">wage1 • wooldridge </a></div>

---

## Para saber mais!

.pull-left[

- [Causal Inference: The Mixtape](https://mixtape.scunning.com/index.html)

<a href="https://mixtape.scunning.com/index.html">
```{r echo=FALSE, out.width="60%", fig.align='center'}
knitr::include_graphics("img/slides/54-casual-inference.png")
```
</a>

]

.pull-right[

- [An Introduction to Statistical Learning: with Applications in R](https://hastie.su.domains/ISLRv2_website.pdf)

<a href="https://mixtape.scunning.com/index.html">
```{r echo=FALSE, out.width="60%", fig.align='center'}
knitr::include_graphics("img/slides/55-introduction-statistical-learning.png")
```
</a>

]

---

# Obrigada!

.pull-left[

```{r echo=FALSE, out.width="65%", fig.align='center'}
knitr::include_graphics("https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExNjFlNDgyOTRhMTk5MGE4ZTNmNjg5ZWMzM2NlZDU3ODBmZDU0OGFiNiZlcD12MV9pbnRlcm5hbF9naWZzX2dpZklkJmN0PWc/M9NbzZjAcxq9jS9LZJ/giphy.gif")
```

.center[Agradecimento especial a [Curso-R](https://curso-r.com/) pelos materiais.]

.center[Slides criados usando os pacotes em R:]
.center[[**xaringan**](https://github.com/yihui/xaringan)]
.center[[**xaringanthemer**](https://github.com/gadenbuie/xaringanthemer)]

.center[O chakra vem da biblioteca JavaScript [remark.js](https://remarkjs.com), [**knitr**](http://yihui.name/knitr), and [R Markdown](https://rmarkdown.rstudio.com).]
]

.pull-right[

```{r echo=FALSE, out.width="55%", fig.align='center'}
knitr::include_graphics("img/slides/19-luisa.jpg")
```

.center[<i class="fas fa-home"></i> [luisa.rbind.io](https://luisa.rbind.io/)]

.center[<i class="fab fa-twitter"></i> [@lgiselebock](https://twitter.com/lgiselebock)]

.center[<i class="fab fa-github"></i> [@lgiselebock](https://github.com/lgiselebock/)]

.center[<i class="far fa-envelope"></i> [luisa.bock@acad.ufsm.br](mailto:luisa.bock@acad.ufsm.br)]
]

<!-- inicio academic icons -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
<!-- final academic icons -->

 
<!-- inicio font awesome -->
<script src="https://kit.fontawesome.com/1f72d6921a.js" crossorigin="anonymous"></script>

<!-- final font awesome -->






